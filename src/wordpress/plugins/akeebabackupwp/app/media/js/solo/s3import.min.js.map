{"version":3,"file":"s3import.min.js","names":["akeeba","S3Import","delayedApplicationOfS3KeysInGUI","elAccessKey","document","getElementById","elSecretKey","setTimeout","value","System","getOptions","resetRoot","changeDirectory","e","elTarget","target","encodedPrefix","data","get","atob","forms","adminForm","submit","importFile","encodedName","objectName","window","location","encodeURIComponent","documentReady","addEventListener","iterateNodes","el","redirectionURL"],"sources":["s3import.js"],"sourcesContent":["/**\n * @package   solo\n * @copyright Copyright (c)2014-2023 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\nif (typeof akeeba == \"undefined\")\n{\n    var akeeba = {};\n}\n\nif (typeof akeeba.S3Import == \"undefined\")\n{\n    akeeba.S3Import = {};\n}\n\nakeeba.S3Import.delayedApplicationOfS3KeysInGUI = function ()\n{\n    var elAccessKey = document.getElementById(\"s3access\");\n    var elSecretKey = document.getElementById(\"s3secret\");\n\n    if ((elAccessKey === null) || (elSecretKey === null))\n    {\n        return;\n    }\n\n    /**\n     * This makes sure that the S3 access and secret keys are not replaced by the browser or a password manager browser\n     * extensions with some arbitrary username and password combination.\n     */\n    setTimeout(function ()\n    {\n        document.getElementById(\"s3access\").value = akeeba.System.getOptions(\"akeeba.S3Import.accessKey\");\n        document.getElementById(\"s3secret\").value = akeeba.System.getOptions(\"akeeba.S3Import.secretKey\");\n    }, 500);\n};\n\n//=============================================================================\n// Akeeba Backup Pro - Import arbitrary archives from S3\n//=============================================================================\n\nakeeba.S3Import.resetRoot = function ()\n{\n    document.getElementById(\"ak_s3import_folder\").value = \"\";\n\n    return true;\n};\n\nakeeba.S3Import.changeDirectory = function (e)\n{\n    var elTarget      = e.target;\n    var encodedPrefix = akeeba.System.data.get(elTarget, \"s3prefix\", \"\");\n\n    document.getElementById(\"ak_s3import_folder\").value = atob(encodedPrefix);\n    document.forms.adminForm.submit();\n};\n\n/**\n *\n * @param {Event} e\n */\nakeeba.S3Import.importFile = function (e)\n{\n    var elTarget    = e.target;\n    var encodedName = akeeba.System.data.get(elTarget, \"s3object\", \"\");\n    var objectName  = atob(encodedName);\n\n    if (objectName === \"\")\n    {\n        return false;\n    }\n\n    window.location = akeeba.System.getOptions(\"akeeba.S3Import.importURL\") + \"&file=\" + encodeURIComponent(objectName);\n};\n\nakeeba.System.documentReady(function ()\n{\n    akeeba.S3Import.delayedApplicationOfS3KeysInGUI();\n\n    akeeba.System.addEventListener(\"akeebaS3ImportResetRoot\", \"click\", akeeba.S3Import.resetRoot);\n\n    akeeba.System.iterateNodes(\".akeebaS3ImportChangeDirectory\", function (el)\n    {\n        akeeba.System.addEventListener(el, \"click\", akeeba.S3Import.changeDirectory);\n    });\n\n    akeeba.System.iterateNodes(\".akeebaS3ImportObjectDownload\", function (el)\n    {\n        akeeba.System.addEventListener(el, \"click\", akeeba.S3Import.importFile);\n    });\n\n    var redirectionURL = akeeba.System.getOptions(\"akeeba.S3Import.autoRedirectURL\", \"\");\n\n    if (redirectionURL !== '')\n    {\n        window.location = redirectionURL;\n    }\n});\n"],"mappings":"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"}